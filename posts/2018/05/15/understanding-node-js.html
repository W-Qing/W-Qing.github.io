<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>åˆè¯†Node.js | â˜€ï¸W-Qing</title>
    <meta name="description" content="ä¸€åˆ‡èƒ½ç”¨ JS å®ç°çš„ï¼Œç»ˆå°†è¢« JS å®ç°ã€‚">
    <link rel="shortcut icon" href="/img/favicon-32.ico">
    
    <link rel="preload" href="/assets/css/1.styles.6564a650.css" as="style"><link rel="preload" href="/assets/js/vendor.2.6564a650.js" as="script"><link rel="preload" href="/assets/js/vendor.1.d0cf3ae5.js" as="script"><link rel="preload" href="/assets/css/0.styles.6b1a4519.css" as="style"><link rel="preload" href="/assets/js/vendor.0.6b1a4519.js" as="script"><link rel="preload" href="/assets/js/app.04778fcb.js" as="script"><link rel="preload" href="/assets/js/23.7d8ddf80.js" as="script"><link rel="prefetch" href="/assets/css/4.styles.2f04305e.css"><link rel="prefetch" href="/assets/css/5.styles.89162a5d.css"><link rel="prefetch" href="/assets/css/6.styles.99a56a85.css"><link rel="prefetch" href="/assets/css/7.styles.53d3c094.css"><link rel="prefetch" href="/assets/js/10.94f9d911.js"><link rel="prefetch" href="/assets/js/11.89dc6fd2.js"><link rel="prefetch" href="/assets/js/12.963b9fbf.js"><link rel="prefetch" href="/assets/js/13.f92b900e.js"><link rel="prefetch" href="/assets/js/14.e088c581.js"><link rel="prefetch" href="/assets/js/15.e53cbc43.js"><link rel="prefetch" href="/assets/js/16.3d2b9c07.js"><link rel="prefetch" href="/assets/js/17.30876b8b.js"><link rel="prefetch" href="/assets/js/18.46c352fd.js"><link rel="prefetch" href="/assets/js/19.1f0fe006.js"><link rel="prefetch" href="/assets/js/20.1c173acf.js"><link rel="prefetch" href="/assets/js/21.a65fd53c.js"><link rel="prefetch" href="/assets/js/22.817c26f4.js"><link rel="prefetch" href="/assets/js/24.9383d989.js"><link rel="prefetch" href="/assets/js/25.83ed1e20.js"><link rel="prefetch" href="/assets/js/26.e03a39dc.js"><link rel="prefetch" href="/assets/js/27.b8eee71e.js"><link rel="prefetch" href="/assets/js/28.13da66fa.js"><link rel="prefetch" href="/assets/js/29.b893c11c.js"><link rel="prefetch" href="/assets/js/30.c5634309.js"><link rel="prefetch" href="/assets/js/4.2f04305e.js"><link rel="prefetch" href="/assets/js/5.89162a5d.js"><link rel="prefetch" href="/assets/js/6.99a56a85.js"><link rel="prefetch" href="/assets/js/7.53d3c094.js"><link rel="prefetch" href="/assets/js/8.cec7f5a5.js"><link rel="prefetch" href="/assets/js/9.3033b784.js">
    <link rel="stylesheet" href="/assets/css/1.styles.6564a650.css"><link rel="stylesheet" href="/assets/css/0.styles.6b1a4519.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/background/header.jpg);" data-v-0539f1bd><div data-v-39c72c19 data-v-0539f1bd><nav class="navbar" data-v-39c72c19><div class="container" data-v-39c72c19><a href="/" class="router-link-active" data-v-39c72c19><span class="navbar-site-name" data-v-39c72c19>
          â˜€ï¸W-Qing
        </span></a> <div class="navbar-toggler" data-v-39c72c19><svg class="icon" style="font-size:1.2em;" data-v-39c72c19 data-v-39c72c19><title data-v-39c72c19 data-v-39c72c19>menu</title><use xlink:href="#icon-menu" data-v-39c72c19 data-v-39c72c19></use></svg></div> <div class="navbar-links" data-v-39c72c19><a href="/" class="navbar-link" data-v-39c72c19>
            Home
          </a><a href="/posts/" class="navbar-link router-link-active" data-v-39c72c19>
            Posts
          </a><a href="/life" class="navbar-link" data-v-39c72c19>
            Life
          </a><a href="/about/" class="navbar-link" data-v-39c72c19>
            About
          </a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-39c72c19></div></div> <div class="banner" data-v-98d6aa8c data-v-0539f1bd data-v-0539f1bd><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-0539f1bd>
          åˆè¯†Node.js
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-6cd81e6a data-v-6cd81e6a><main class="main" data-v-6cd81e6a><div class="post" data-v-6cd81e6a data-v-6cd81e6a><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      å‘å¸ƒæ—¶é—´ : 2018-05-15
    </span> <!----></section> <section class="post-links" data-v-4e23451f><a href="/posts/2018/04/03/es6-basic-study-notes.html" class="post-link" data-v-4e23451f>
      ä¸Šä¸€ç¯‡ : ES6å­¦ä¹ ç¬”è®°
    </a> <a href="/posts/2018/05/18/node-js-simple-guestbook.html" class="post-link" data-v-4e23451f>
      ä¸‹ä¸€ç¯‡ : Node.jså®ç°ç®€å•çš„ç•™è¨€æœ¬
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><h2 id="node-jsæ˜¯ä»€ä¹ˆ"><a href="#node-jsæ˜¯ä»€ä¹ˆ" aria-hidden="true" class="header-anchor">#</a> Node.jsæ˜¯ä»€ä¹ˆ?</h2> <p><strong>Node.jsÂ® is a JavaScript runtime built on Chromeâ€™s V8 JavaScript engine.Node.js uses an event-driven, non-blocking I/O model that makes it lightweight and efficient.Node.jsâ€™ package ecosystem, npm, is the largest ecosystem of open source libraries in the world.</strong></p> <blockquote><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚Node.js ä½¿ç”¨äº†ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ã€éé˜»å¡å¼ I/O çš„æ¨¡å‹ï¼Œä½¿å…¶è½»é‡åˆé«˜æ•ˆã€‚Node.js çš„åŒ…ç®¡ç†å™¨ npmï¼Œæ˜¯å…¨çƒæœ€å¤§çš„å¼€æºåº“ç”Ÿæ€ç³»ç»Ÿã€‚</p></blockquote> <p>ğŸ—¿<strong>Node.js æ—¢ä¸æ˜¯ä¸€é—¨æ–°çš„è¯­è¨€ï¼Œä¹Ÿä¸æ˜¯æ¡†æ¶ï¼Œå®ƒæ˜¯ JavaScript åœ¨æœåŠ¡å™¨ç«¯çš„è¿è¡Œç¯å¢ƒ ã€‚</strong></p> <p>æ‰€è°“â€œè¿è¡Œç¯å¢ƒï¼ˆå¹³å°ï¼‰â€æœ‰ä¸¤å±‚æ„æ€ï¼š</p> <ol><li>é¦–å…ˆï¼Œ<strong>ç¼–ç¨‹è¯­è¨€èƒ½åšä»€ä¹ˆå–å†³äºå¹³å°ï¼Œä¹Ÿå°±æ˜¯å®ƒçš„è¿è¡Œç¯å¢ƒã€‚</strong> JavaScript æœ€æ—©æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œç„¶è€Œæµè§ˆå™¨åªæ˜¯æä¾›äº†ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œå®ƒå®šä¹‰äº†ä½¿ç”¨ JavaScript å¯ä»¥åšä»€ä¹ˆï¼Œä½†å¹¶æ²¡æœ‰â€œè¯´â€å¤ªå¤šå…³äº JavaScript è¯­è¨€æœ¬èº«å¯ä»¥åšä»€ä¹ˆã€‚äº‹å®ä¸Šï¼ŒJS æ˜¯ä¸€é—¨â€œå®Œæ•´â€çš„è¯­è¨€ï¼Œå®ƒå¯ä»¥ä½¿ç”¨åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå…¶èƒ½åŠ›ä¸å…¶ä»–åŒç±»è¯­è¨€ç›¸æ¯”æœ‰è¿‡ä¹‹è€Œæ— ä¸åŠã€‚Node äº‹å®ä¸Šå°±æ˜¯å¦å¤–ä¸€ç§ä¸Šä¸‹æ–‡ï¼Œ å†…éƒ¨ä½¿ç”¨ Google Chrome çš„ V8  å¼•æ“åœ¨æœåŠ¡ç«¯è§£é‡Šæ‰§è¡Œ JavaScript ä»£ç ï¼Œåœ¨è¿™ä¸ªæ„ä¹‰ä¸Š Node æœ‰ç‚¹åƒ JavaScript çš„è™šæ‹Ÿæœºã€‚</li> <li>å…¶æ¬¡ï¼Œ<strong>æ˜¯ Node é€‰æ‹©äº† JavaScriptï¼Œè€Œä¸æ˜¯ JavaScript å‘å±•å‡ºäº† Nodeã€‚</strong> Node æä¾›å¤§é‡å·¥å…·åº“ï¼ˆé€šè¿‡è‡ªè¡Œå¼€å‘çš„ libuv åº“ï¼Œè°ƒç”¨ç³»ç»Ÿèµ„æºï¼‰ï¼Œä½¿å¾— JavaScript è¯­è¨€ä¸æ“ä½œç³»ç»Ÿäº¤äº’ï¼ˆæ¯”å¦‚æ–‡ä»¶è¯»å†™ï¼Œæ–°å»ºå­è¿›ç¨‹ï¼‰ï¼Œåœ¨è¿™ä¸ªæ„ä¹‰ä¸Šï¼ŒNode åˆæ˜¯JavaScript çš„å·¥å…·åº“ã€‚</li></ol> <h2 id="node-jsèƒ½å¹²ä»€ä¹ˆ"><a href="#node-jsèƒ½å¹²ä»€ä¹ˆ" aria-hidden="true" class="header-anchor">#</a> Node.jsèƒ½å¹²ä»€ä¹ˆ?</h2> <ul><li>é«˜æ€§èƒ½çš„WebæœåŠ¡å™¨</li> <li>å®æ—¶å¤šäººæ¸¸æˆåå°æœåŠ¡å™¨</li> <li>ç®€å•æ˜“ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼ˆnpm hexoï¼‰</li> <li>gulpã€bowerã€fisã€http-server</li> <li>é«˜å¤§ä¸Šçš„æ¡Œé¢åº”ç”¨ç¨‹åº</li> <li>electron Linus + Max + Windows</li> <li>åº•å±‚çš„ç‰©è”ç½‘å¼€å‘</li> <li>ç§»åŠ¨å¼€å‘</li> <li>â€¦ â€¦</li></ul> <h2 id="è®¤è¯†-node-ä¸­çš„-javascript"><a href="#è®¤è¯†-node-ä¸­çš„-javascript" aria-hidden="true" class="header-anchor">#</a> è®¤è¯† Node ä¸­çš„ Javascript</h2> <ul><li><p>ECMAScript</p> <blockquote><p>å’Œæµè§ˆå™¨ç¯å¢ƒä¸­çš„Javascriptä¸ä¸€æ ·ï¼ŒNodeæ²¡æœ‰DOMå’ŒBOMå¯¹è±¡ï¼ˆconsole.log(window)æˆ–console.log(document)ä¼šæŠ¥é”™ï¼‰ï¼ŒNode.js ä¸­çš„å…¨å±€å¯¹è±¡æ˜¯ globalï¼Œæ‰€æœ‰å…¨å±€å˜é‡ï¼ˆé™¤äº† global æœ¬èº«ä»¥å¤–ï¼‰éƒ½æ˜¯ global å¯¹è±¡çš„å±æ€§ã€‚</p></blockquote></li> <li><p>æ ¸å¿ƒæ¨¡å—</p> <blockquote><p>Nodeä¸ºJavascriptæä¾›äº†å¾ˆå¤šæœåŠ¡å™¨çº§åˆ«çš„APIï¼Œè¿™äº›APIå¤§å¤šéƒ½è¢«åŒ…è£…åˆ°äº†ä¸€ä¸ªå…·åçš„æ ¸å¿ƒæ¨¡å—ä¸­ï¼Œä¾‹å¦‚æ–‡ä»¶æ“ä½œçš„<code>fs</code>æ¨¡å—ï¼ŒhttpæœåŠ¡æ„å»ºçš„<code>http</code>æ¨¡å—ã€è·¯å¾„æ“ä½œçš„<code>path</code>æ¨¡å—ã€<code>os</code>æ“ä½œç³»ç»Ÿä¿¡æ¯æ¨¡å—â€¦â€¦</p></blockquote></li> <li><p>ç”¨æˆ·è‡ªå®šä¹‰æ¨¡å—ã€ç¬¬ä¸‰æ–¹æ¨¡å—</p> <blockquote><p>ç›¸å¯¹è·¯å¾„å¿…é¡»åŠ  â€˜./â€˜ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p> <p>å¯ä»¥çœç•¥ .jsåç¼€åï¼ˆæ¨èï¼‰</p></blockquote></li> <li><p>æ¨¡å—ç³»ç»Ÿ</p> <blockquote><p>Nodeä¸­è¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µï¼šæ¨¡å—ç³»ç»Ÿï¼ˆ å…¶éµå¾ªCommonJSçš„æ¨¡å—è§„èŒƒï¼‰</p></blockquote></li></ul> <h2 id="åˆ›å»ºä¸€ä¸ªç®€å•çš„-http-æœåŠ¡åº”ç”¨"><a href="#åˆ›å»ºä¸€ä¸ªç®€å•çš„-http-æœåŠ¡åº”ç”¨" aria-hidden="true" class="header-anchor">#</a> åˆ›å»ºä¸€ä¸ªç®€å•çš„ Http æœåŠ¡åº”ç”¨</h2> <p>Node.js åº”ç”¨æ˜¯ç”±å“ªå‡ éƒ¨åˆ†ç»„æˆçš„ï¼š</p> <ol><li><strong>å¼•å…¥ required æ¨¡å—ï¼š</strong> æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>require</strong> æŒ‡ä»¤æ¥è½½å…¥ Node.js æ¨¡å—ã€‚</li> <li><strong>åˆ›å»ºæœåŠ¡å™¨ï¼š</strong> æœåŠ¡å™¨å¯ä»¥ç›‘å¬å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œç±»ä¼¼äº Apache ã€Nginx ç­‰ HTTP æœåŠ¡å™¨ã€‚</li> <li><strong>æ¥æ”¶è¯·æ±‚ä¸å“åº”è¯·æ±‚ï¼š</strong>  å®¢æˆ·ç«¯é€šè¿‡æµè§ˆå™¨æˆ–ç»ˆç«¯å‘é€ HTTP è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ¥æ”¶è¯·æ±‚åè¿”å›å“åº”æ•°æ®ã€‚</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//ä½¿ç”¨requireæ–¹æ³•åŠ è½½httpæ ¸å¿ƒæ¨¡å—</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>

<span class="token comment">//å®šä¹‰æœåŠ¡å™¨çš„ä¸»æœºåä¸ç«¯å£å·</span>
<span class="token keyword">const</span> hostname <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">3000</span>

<span class="token comment">//ä½¿ç”¨http.creatServer() æ–¹æ³•åˆ›å»ºä¸€ä¸ªwebæœåŠ¡å™¨</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">200</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/plain'</span><span class="token punctuation">)</span><span class="token comment">//è®¾ç½®è¯·æ±‚å¤´</span>
  <span class="token comment">//res.write('Hello World\n')</span>
  <span class="token comment">//res.end()</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'Hello World\n'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//ç»‘å®šä¸»æœºåä¸ç«¯å£å· å¯åŠ¨æœåŠ¡å™¨</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> hostname<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Server running at http://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hostname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>å¿…é¡»ä½¿ç”¨res.end()æ¥ç»“æŸå“åº”ï¼Œå¦åˆ™å®¢æˆ·ç«¯ä¼šä¸€ç›´ç­‰å¾…</li></ul> <h2 id="fsæ–‡ä»¶ç³»ç»Ÿæ¨¡å—"><a href="#fsæ–‡ä»¶ç³»ç»Ÿæ¨¡å—" aria-hidden="true" class="header-anchor">#</a> fsæ–‡ä»¶ç³»ç»Ÿæ¨¡å—</h2> <p>åœ¨Nodeä¸­å¦‚æœæƒ³è¦è¿›è¡Œæ–‡ä»¶æ“ä½œï¼Œå¿…é¡»å¼•å…¥file-systemè¿™ä¸ªæ ¸å¿ƒæ¨¡å—ã€‚å®ƒæä¾›äº†æ‰€æœ‰çš„æ–‡ä»¶æ“ä½œç›¸å…³çš„APIã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//ä½¿ç”¨requireæ–¹æ³•åŠ è½½fsæ ¸å¿ƒæ¨¡å—</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// å¼‚æ­¥è¯»å–</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'demo.txt'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token comment">//æ­¤æ—¶errä¸ºnull</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;å¼‚æ­¥è¯»å–: &quot;</span> <span class="token operator">+</span> data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token comment">//é»˜è®¤æ–‡ä»¶ä¸­å­˜å‚¨çš„äºŒè¿›åˆ¶æ•°æ®è¢«è½¬ä¸º16è¿›åˆ¶è¾“å‡º</span>
   <span class="token comment">//&lt;Buffer 68 65 6c 6c 6f 20 6e 6f 64 65 2e 6a 73&gt;</span>
   <span class="token comment">//ä½¿ç”¨toStringæ–¹æ³•å°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²è¾“å‡º hello node.js</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>ç»™å®¢æˆ·ç«¯å‘é€çš„å“åº”ä¿¡æ¯å¿…é¡»ä¸ºå­—ç¬¦ä¸²æˆ–è€…æ˜¯äºŒè¿›åˆ¶æ•°æ®</li> <li>å› æ­¤console.log()æ‰“å°æ–‡ä»¶å†…å®¹æˆ–ä½¿ç”¨res.write()å‘é¡µé¢è¿”å›ä¿¡æ¯éœ€è¦ä½¿ç”¨toStringæ–¹æ³•</li></ul> <h2 id="æ ¹æ®ä¸åŒè¯·æ±‚è·¯å¾„è¿”å›ä¸åŒæ•°æ®"><a href="#æ ¹æ®ä¸åŒè¯·æ±‚è·¯å¾„è¿”å›ä¸åŒæ•°æ®" aria-hidden="true" class="header-anchor">#</a> æ ¹æ®ä¸åŒè¯·æ±‚è·¯å¾„è¿”å›ä¸åŒæ•°æ®</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span>url
  <span class="token comment">//Request è¯·æ±‚å¯¹è±¡ ç”¨æ¥è·å–å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯ è¾“å…¥ï¼ˆåœ°å€ã€æ—¶é—´ã€ipã€æ–¹æ³•ï¼‰</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`å®¢æˆ·ç«¯è¯·æ±‚çš„åœ°å€æ˜¯ï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>
  <span class="token comment">//Response å“åº”å¯¹è±¡ ç”¨æ¥ç»™å®¢æˆ·ç«¯å‘é€å“åº”ä¿¡æ¯ è¾“å‡º</span>
  <span class="token comment">//é€šè¿‡ä¿®æ”¹setHeaderçš„Content-Typeæ¥æŒ‡å®šå“åº”å†…å®¹çš„ç±»å‹ </span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/plain;charset=utf-8'</span><span class="token punctuation">)</span>
  <span class="token comment">//'text/plain;'æ™®é€šæ–‡æœ¬  'text/html' htmlæ–‡æœ¬ image/jpeg .jpgå›¾ç‰‡</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//è¯»å–htmlæ–‡ä»¶å¹¶è¿”å›</span>
        fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    		<span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
    			res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶è¯»å–å¤±è´¥'</span><span class="token punctuation">)</span>
    		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    			res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span><span class="token string">'text/html;charset=utf-8'</span><span class="token punctuation">)</span>
    			res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//end()æ–¹æ³•å¯æ¥å—dataï¼ˆé»˜è®¤äºŒè¿›åˆ¶ï¼‰æ•°æ® ä¸ç”¨toString()è½¬æˆå­—ç¬¦ä¸²</span>
    		<span class="token punctuation">}</span>
    	<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">'api'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                name<span class="token punctuation">:</span><span class="token string">'è‹¹æœ'</span><span class="token punctuation">,</span>
                price<span class="token punctuation">:</span> <span class="token number">10</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                name<span class="token punctuation">:</span><span class="token string">'æ¨±æ¡ƒ'</span><span class="token punctuation">,</span>
                price<span class="token punctuation">:</span> <span class="token number">15</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">'/image'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./image/products.jpg'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
                res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'å›¾ç‰‡è¯»å–å¤±è´¥'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span><span class="token string">'image/jpeg'</span><span class="token punctuation">)</span><span class="token comment">//å›¾ç‰‡ï¼ˆéå­—ç¬¦ï¼‰ä¸éœ€è¦æŒ‡å®šç¼–ç æ ¼å¼</span>
                res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;404 Not Found!&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>æœåŠ¡ç«¯é»˜è®¤å‘é€çš„å­—ç¬¦æ•°æ®ï¼Œé»˜è®¤ä¸ºutf-8ç¼–ç </li> <li>æµè§ˆå™¨åœ¨ä¸çŸ¥é“æœåŠ¡å™¨å“åº”å†…å®¹ç¼–ç æ ¼å¼çš„æ—¶å€™ä¼šæŒ‰ç…§å½“å‰æ“ä½œç³»ç»Ÿçš„é»˜è®¤ç¼–ç å»è§£æ</li> <li>ä¸­æ–‡æ“ä½œç³»ç»Ÿé»˜è®¤å­—ç¬¦ç¼–ç ä¸º gkbï¼Œä¼šå¯¼è‡´é¡µé¢ä¹±ç  æ­¤æ—¶å¯ä»¥é€šè¿‡<code>charaset = utf-8</code>æŒ‡å®šå­—ç¬¦ç¼–ç æ ¼å¼</li></ul> <h2 id="urlè·¯ç”±æ¨¡å—"><a href="#urlè·¯ç”±æ¨¡å—" aria-hidden="true" class="header-anchor">#</a> urlè·¯ç”±æ¨¡å—</h2> <p>é€šè¿‡åˆ¤æ–­Requestå¯¹è±¡çš„ä¸åŒurlå¯ä»¥ç›¸åº”åœ°è¿”å›ä¸åŒçš„æ•°æ®ã€‚ä½†å½“ç”¨æˆ·é€šè¿‡getæ–¹å¼è¯·æ±‚è¡¨å•æ•°æ®æ—¶ï¼Œå½¢å¦‚ï¼š<code>comments?name=mintnoii&amp;message=ä½ å¥½</code>ï¼Œç”±äºå…¶ä¸­å«æœ‰ç”¨æˆ·åŠ¨æ€å¡«å†™çš„å†…å®¹ï¼Œæ‰€ä»¥ä¸å¯èƒ½é€šè¿‡å»åˆ¤æ–­å®Œæ•´çš„ url è·¯å¾„æ¥å¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚å¯¹æ­¤å¯ä»¥å¼•å…¥Nodeä¸­çš„urlè·¯ç”±æ¨¡å—<code>const url = require(&quot;url&quot;);</code>æ¥æ ¹æ®ä¸åŒçš„è¯·æ±‚è·¯å¾„æ¥è®¾ç½®è·¯ç”±é€‰æ‹©ã€‚urlä¸€å…±æä¾›äº†ä¸‰ä¸ªæ–¹æ³•ï¼š</p> <h3 id="_1ã€url-parse-urlstring-boolean-boolean"><a href="#_1ã€url-parse-urlstring-boolean-boolean" aria-hidden="true" class="header-anchor">#</a> 1ã€url.parse(<strong>urlString,boolean,boolean</strong> )</h3> <p>å°†ä¸€ä¸ªurlçš„å­—ç¬¦ä¸²è§£æå¹¶è¿”å›ä¸€ä¸ªurlçš„å¯¹è±¡</p> <div class="language-js extra-class"><pre class="language-js"><code>url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;http://user:pass@host.com:8080/p/a/t/h?query=string#hash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

è¿”å›å€¼ï¼š
<span class="token punctuation">{</span>
  protocol<span class="token punctuation">:</span> <span class="token string">'http:'</span><span class="token punctuation">,</span>   <span class="token comment">// åº•å±‚ä½¿ç”¨çš„åè®®</span>
  slashes<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>       <span class="token comment">// æ˜¯å¦æœ‰åè®®çš„åŒæ–œçº¿</span>
  auth<span class="token punctuation">:</span> <span class="token string">'user:pass'</span><span class="token punctuation">,</span>
  host<span class="token punctuation">:</span> <span class="token string">'host.com:8080'</span><span class="token punctuation">,</span>   <span class="token comment">// http æ˜¯æœåŠ¡å™¨çš„ipåœ°å€æˆ–è€…æ˜¯åŸŸå</span>
  port<span class="token punctuation">:</span> <span class="token string">'8080'</span><span class="token punctuation">,</span>            <span class="token comment">// ç«¯å£å·</span>
  hostname<span class="token punctuation">:</span> <span class="token string">'host.com'</span><span class="token punctuation">,</span>	   <span class="token comment">// ä¸»æœºå</span>
  hash<span class="token punctuation">:</span> <span class="token string">'#hash'</span><span class="token punctuation">,</span>		  <span class="token comment">// å“ˆå¸Œå€¼ å¯¹åº”çš„æ˜¯é¡µé¢ä¸Šçš„é”šç‚¹</span>
  search<span class="token punctuation">:</span> <span class="token string">'?query=string'</span><span class="token punctuation">,</span> 		<span class="token comment">// æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°</span>
  query<span class="token punctuation">:</span> <span class="token string">'query=string'</span><span class="token punctuation">,</span>		<span class="token comment">// å‘é€ç»™httpçš„æ•°æ® ç­‰å·åˆ†å‰²çš„é”®å€¼ç§°ä¸ºå‚æ•°ä¸² å­—ç¬¦ä¸²</span>
  pathname<span class="token punctuation">:</span> <span class="token string">'/p/a/t/h'</span><span class="token punctuation">,</span>			<span class="token comment">// è®¿é—®èµ„æºçš„è·¯å¾„å</span>
  path<span class="token punctuation">:</span> <span class="token string">'/p/a/t/h?query=string'</span><span class="token punctuation">,</span>	<span class="token comment">//  è·¯å¾„</span>
  href<span class="token punctuation">:</span> <span class="token string">'http://user:pass@host.com:8080/p/a/t/h?query=string#hash'</span> <span class="token comment">// æ²¡è¢«è§£æçš„å®Œæ•´çš„è¶…é“¾æ¥åœ°å€</span>
 <span class="token punctuation">}</span>
</code></pre></div><ul><li>æ²¡æœ‰æŠŠç¬¬äºŒä¸ªå‚æ•°(é»˜è®¤ä¸ºfalse)è®¾ç½®ä¸ºtrueæ—¶ï¼Œqueryå±æ€§ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;http://user:pass@host.com:8080/p/a/t/h?query=string#hash&quot;</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//æŠŠç¬¬äºŒä¸ªå‚æ•°è®¾ç½®ä¸ºtrueï¼Œnodeä¼šç”¨queryStræ–¹æ³•å»è§£æurlï¼Œå¹¶å°†queryå±æ€§å˜æˆå¯¹è±¡</span>
query<span class="token punctuation">:</span> <span class="token punctuation">{</span> query<span class="token punctuation">:</span> <span class="token string">'string'</span> <span class="token punctuation">}</span>
</code></pre></div><ul><li>è‹¥parseçš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºtrueï¼Œè§£ææ—¶ä¼šå°†urlçš„â€//â€œå’Œç¬¬ä¸€ä¸ªâ€/â€œä¹‹é—´çš„éƒ¨åˆ†è§£æä¸ºä¸»æœºå</li></ul> <h3 id="_2ã€url-format-urlobj"><a href="#_2ã€url-format-urlobj" aria-hidden="true" class="header-anchor">#</a> 2ã€url.format(urlObj)</h3> <p>å°†ä¼ å…¥çš„urlå¯¹è±¡ç¼–ç¨‹ä¸€ä¸ªurlå­—ç¬¦ä¸²å¹¶è¿”å›</p> <div class="language-js extra-class"><pre class="language-js"><code>url<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
protocol<span class="token punctuation">:</span> <span class="token string">'http:'</span><span class="token punctuation">,</span>
hostname<span class="token punctuation">:</span><span class="token string">'www.baidu.com'</span><span class="token punctuation">,</span>
port<span class="token punctuation">:</span><span class="token string">'80'</span><span class="token punctuation">,</span>
pathname <span class="token punctuation">:</span><span class="token string">'/news'</span><span class="token punctuation">,</span>
query<span class="token punctuation">:</span><span class="token punctuation">{</span>page<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

è¿”å›å€¼ï¼š
http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>baidu<span class="token punctuation">.</span>com<span class="token operator">/</span>news<span class="token operator">?</span>page<span class="token operator">=</span><span class="token number">1</span>
</code></pre></div><h3 id="_3ã€url-resolve-from-to"><a href="#_3ã€url-resolve-from-to" aria-hidden="true" class="header-anchor">#</a> 3ã€url.resolve(<strong>from,to</strong> )</h3> <p>è¿”å›ä¸€ä¸ªæ ¼å¼ä¸ºâ€from/toâ€çš„å­—ç¬¦ä¸²</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åŸŸå,ç¬¬äºŒä¸ªå‚æ•°æ˜¯ path è·¯å¾„ï¼ˆå‰é¢å¸¦ä¸å¸¦ / éƒ½è¡Œï¼‰</span>
 url<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'http://www.imooc.com'</span><span class="token punctuation">,</span><span class="token string">'/course/list?c=fe'</span><span class="token punctuation">)</span>

è¿”å›å€¼ï¼š
<span class="token string">'http://www.imooc.com/course/list?c=fe'</span>
</code></pre></div></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      å‘å¸ƒæ—¶é—´ : 2018-05-15
    </span> <!----></section> <section class="post-links" data-v-4e23451f><a href="/posts/2018/04/03/es6-basic-study-notes.html" class="post-link" data-v-4e23451f>
      ä¸Šä¸€ç¯‡ : ES6å­¦ä¹ ç¬”è®°
    </a> <a href="/posts/2018/05/18/node-js-simple-guestbook.html" class="post-link" data-v-4e23451f>
      ä¸‹ä¸€ç¯‡ : Node.jså®ç°ç®€å•çš„ç•™è¨€æœ¬
    </a></section></section> <!----></div></main> <aside class="aside" data-v-6cd81e6a><div class="info-card main-div" data-v-3da8ff8d data-v-6cd81e6a><div class="info-card-header" data-v-3da8ff8d><img src="/img/avatar.png" alt="W-Qing" class="info-avatar" data-v-3da8ff8d></div> <div class="info-card-body" data-v-3da8ff8d><section class="info-nickname" data-v-3da8ff8d>
      W-Qing
    </section> <section class="info-desc" data-v-3da8ff8d>I may be lonely,<br/>but l'm not stupid,<br/>l try to live with my mistake.</section> <section class="info-contact" data-v-3da8ff8d><section data-v-3da8ff8d><span title="Shanghai City, China" data-v-3da8ff8d data-v-3da8ff8d><svg class="icon" style="font-size:1em;" data-v-3da8ff8d data-v-3da8ff8d><title data-v-3da8ff8d data-v-3da8ff8d>Shanghai City, China</title><use xlink:href="#icon-location" data-v-3da8ff8d data-v-3da8ff8d></use></svg><span class="info-text" data-v-3da8ff8d data-v-3da8ff8d>
          Shanghai City, China
        </span></span></section> <section data-v-3da8ff8d><span title="Ludong University" data-v-3da8ff8d data-v-3da8ff8d><svg class="icon" style="font-size:1em;" data-v-3da8ff8d data-v-3da8ff8d><title data-v-3da8ff8d data-v-3da8ff8d>Ludong University</title><use xlink:href="#icon-organization" data-v-3da8ff8d data-v-3da8ff8d></use></svg><span class="info-text" data-v-3da8ff8d data-v-3da8ff8d>
          Ludong University
        </span></span></section> <section data-v-3da8ff8d><a href="mailto:sunburst.wang@qq.com" title="sunburst.wang@qq.com" data-v-3da8ff8d data-v-3da8ff8d><svg class="icon" style="font-size:1em;" data-v-3da8ff8d data-v-3da8ff8d><title data-v-3da8ff8d data-v-3da8ff8d>sunburst.wang@qq.com</title><use xlink:href="#icon-email" data-v-3da8ff8d data-v-3da8ff8d></use></svg><span class="info-text" data-v-3da8ff8d data-v-3da8ff8d>
          sunburst.wang@qq.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-3da8ff8d><section class="info-sns clearfix" data-v-3da8ff8d><a href="https://github.com/W-Qing" target="_blank" class="sns-link" data-v-3da8ff8d><span title="GitHub: W-Qing" class="sns-icon" data-v-3da8ff8d data-v-3da8ff8d><svg class="icon" style="font-size:1.5em;" data-v-3da8ff8d data-v-3da8ff8d><title data-v-3da8ff8d data-v-3da8ff8d>GitHub: W-Qing</title><use xlink:href="#icon-github" data-v-3da8ff8d data-v-3da8ff8d></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-6cd81e6a><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>æ–‡ç« ç›®å½•</span> <div class="post-nav-toc"><ul><li><a href="/posts/2018/05/15/understanding-node-js.html#node-jsæ˜¯ä»€ä¹ˆ">Node.jsæ˜¯ä»€ä¹ˆ?</a></li><li><a href="/posts/2018/05/15/understanding-node-js.html#node-jsèƒ½å¹²ä»€ä¹ˆ">Node.jsèƒ½å¹²ä»€ä¹ˆ?</a></li><li><a href="/posts/2018/05/15/understanding-node-js.html#è®¤è¯†-node-ä¸­çš„-javascript">è®¤è¯† Node ä¸­çš„ Javascript</a></li><li><a href="/posts/2018/05/15/understanding-node-js.html#åˆ›å»ºä¸€ä¸ªç®€å•çš„-http-æœåŠ¡åº”ç”¨">åˆ›å»ºä¸€ä¸ªç®€å•çš„ Http æœåŠ¡åº”ç”¨</a></li><li><a href="/posts/2018/05/15/understanding-node-js.html#fsæ–‡ä»¶ç³»ç»Ÿæ¨¡å—">fsæ–‡ä»¶ç³»ç»Ÿæ¨¡å—</a></li><li><a href="/posts/2018/05/15/understanding-node-js.html#æ ¹æ®ä¸åŒè¯·æ±‚è·¯å¾„è¿”å›ä¸åŒæ•°æ®">æ ¹æ®ä¸åŒè¯·æ±‚è·¯å¾„è¿”å›ä¸åŒæ•°æ®</a></li><li><a href="/posts/2018/05/15/understanding-node-js.html#urlè·¯ç”±æ¨¡å—">urlè·¯ç”±æ¨¡å—</a><ul><li><a href="/posts/2018/05/15/understanding-node-js.html#_1ã€url-parse-urlstring-boolean-boolean">1ã€url.parse(urlString,boolean,boolean )</a></li><li><a href="/posts/2018/05/15/understanding-node-js.html#_2ã€url-format-urlobj">2ã€url.format(urlObj)</a></li></ul></li></ul></div></div> <!----></div></aside></div> <footer class="footer" data-v-1114308c><p class="sns-links" data-v-1114308c><a href="https://github.com/W-Qing" target="_blank" class="sns-link" data-v-1114308c><span title="GitHub: W-Qing" class="sns-icon" data-v-1114308c data-v-1114308c><svg class="icon" style="font-size:25px;" data-v-1114308c data-v-1114308c><title data-v-1114308c data-v-1114308c>GitHub: W-Qing</title><use xlink:href="#icon-github" data-v-1114308c data-v-1114308c></use></svg></span></a></p> <p data-v-1114308c><span data-v-1114308c>Powered by </span> <a href="https://vuepress.vuejs.org" target="_blank" data-v-1114308c>
      Vuepress
    </a></p></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/vendor.2.6564a650.js" defer></script><script src="/assets/js/23.7d8ddf80.js" defer></script><script src="/assets/js/vendor.1.d0cf3ae5.js" defer></script><script src="/assets/js/vendor.0.6b1a4519.js" defer></script><script src="/assets/js/app.04778fcb.js" defer></script>
  </body>
</html>
